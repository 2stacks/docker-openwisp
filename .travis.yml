---
sudo: required
services: docker
language: generic
dist: xenial

branches:
  only:
  - master
  - travis

jobs:
  include:
    - stage: tests
      script:
      # Start containers
      - docker-compose build
      - docker-compose up -d
      # Getting ready to test
      - echo "127.0.0.1 dashboard.openwisp.org controller.openwisp.org radius.openwisp.org topology.openwisp.org" | sudo tee -a /etc/hosts
      - sleep 1m
      # Tests
      - source $TRAVIS_BUILD_DIR/tests/tests.sh
      - init_dashoard_tests
